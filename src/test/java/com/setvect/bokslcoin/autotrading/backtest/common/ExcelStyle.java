package com.setvect.bokslcoin.autotrading.backtest.common;

import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.*;

public class ExcelStyle {
    public static XSSFCellStyle createDefault(XSSFWorkbook workbook) {
        return workbook.createCellStyle();
    }

    public static XSSFCellStyle createDate(XSSFWorkbook workbook) {
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        CreationHelper createHelper = workbook.getCreationHelper();
        cellStyle.setDataFormat(createHelper.createDataFormat().getFormat("yyyy/MM/dd"));
        return cellStyle;
    }

    public static XSSFCellStyle createDateTime(XSSFWorkbook workbook) {
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        CreationHelper createHelper = workbook.getCreationHelper();
        cellStyle.setDataFormat(createHelper.createDataFormat().getFormat("yyyy/MM/dd HH:mm"));
        return cellStyle;
    }

    public static XSSFCellStyle createYearMonth(XSSFWorkbook workbook) {
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        CreationHelper createHelper = workbook.getCreationHelper();
        cellStyle.setDataFormat(createHelper.createDataFormat().getFormat("yyyy/MM"));
        return cellStyle;
    }

    public static XSSFCellStyle createComma(XSSFWorkbook workbook) {
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        DataFormat format = workbook.createDataFormat();
        cellStyle.setDataFormat(format.getFormat("###,###"));
        return cellStyle;
    }

    /**
     * 소수점 표시
     */
    public static XSSFCellStyle createDecimal(XSSFWorkbook workbook) {
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        DataFormat format = workbook.createDataFormat();
        cellStyle.setDataFormat(format.getFormat("0.00"));
        return cellStyle;
    }

    public static XSSFCellStyle createCommaDecimal(XSSFWorkbook workbook) {
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        DataFormat format = workbook.createDataFormat();
        cellStyle.setDataFormat(format.getFormat("###,###.00"));
        return cellStyle;
    }

    public static XSSFCellStyle createPercent(XSSFWorkbook workbook) {
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        DataFormat format = workbook.createDataFormat();
        cellStyle.setDataFormat(format.getFormat("###,##0.00%"));
        return cellStyle;
    }

    public static XSSFCellStyle createHeaderRow(XSSFWorkbook workbook) {
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);
        cellStyle.setFillForegroundColor(IndexedColors.YELLOW.index);

        XSSFFont font = workbook.createFont();
        font.setBold(true);
        cellStyle.setFont(font);
        cellStyle.setAlignment(HorizontalAlignment.CENTER);
        cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);
        return cellStyle;
    }

    /**
     * 모든 셀 border 적용
     */
    public static void applyAllBorder(XSSFSheet sheet) {
        int rowCount = sheet.getPhysicalNumberOfRows();
        for (int rowIdx = 0; rowIdx < rowCount; rowIdx++) {
            XSSFRow row = sheet.getRow(rowIdx);
            int cellCount = row.getPhysicalNumberOfCells();
            for (int cellIdx = 0; cellIdx < cellCount; cellIdx++) {
                XSSFCell cell = row.getCell(cellIdx);
                XSSFCellStyle cellStyle = cell.getCellStyle();
                cellStyle.setBorderLeft(BorderStyle.THIN);
                cellStyle.setBorderRight(BorderStyle.THIN);
                cellStyle.setBorderTop(BorderStyle.THIN);
                cellStyle.setBorderBottom(BorderStyle.THIN);
            }
        }
    }

    public static void applyDefaultFont(XSSFSheet sheet) {
        int rowCount = sheet.getPhysicalNumberOfRows();
        for (int rowIdx = 0; rowIdx < rowCount; rowIdx++) {
            XSSFRow row = sheet.getRow(rowIdx);
            int cellCount = row.getPhysicalNumberOfCells();
            for (int cellIdx = 0; cellIdx < cellCount; cellIdx++) {
                XSSFCellStyle cellStyle = row.getCell(cellIdx).getCellStyle();
                cellStyle.getFont().setFontName("맑은 고딕");
            }
        }
    }
}
